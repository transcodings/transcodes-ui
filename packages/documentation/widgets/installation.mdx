---
title: "설치 안내 (Installation)"
description: "PWA 설치 배너 및 가이드 컴포넌트"
---

PWA 설치를 사용자에게 안내하는 2개의 컴포넌트입니다.

---

## tc-installation-banner

PWA 설치를 권유하는 고정 배너입니다. 사용자의 선택을 localStorage에 저장하여 일정 기간 동안 표시하지 않습니다.

### Properties

| 속성명 | 타입 | 기본값 | 설명 |
|-------|------|-------|------|
| `title` | `string` | `'Install App'` | 배너 제목 |
| `description` | `string` | `'Add to your home screen for quick access'` | 배너 설명 |
| `install-label` | `string` | `'Install'` | 설치 버튼 텍스트 |
| `storage-key` | `string` | `'tc-install-banner-dismissed'` | localStorage 키 |
| `dismiss-days` | `number` | `7` | 일시적 해제 기간 (일 단위) |

### Events

| 이벤트명 | 설명 |
|---------|------|
| `tc-install` | 설치 버튼을 클릭했을 때 발생 |
| `tc-dismiss` | 배너가 닫혔을 때 발생 |

### Methods

| 메서드명 | 반환값 | 설명 |
|---------|-------|------|
| `show()` | `Promise<void>` | 배너 표시 |
| `dismiss()` | `Promise<void>` | 배너 닫기 및 상태 저장 |

### CSS Parts

| Part 이름 | 설명 |
|----------|------|
| `banner` | 배너 컨테이너 |
| `content` | 콘텐츠 영역 |
| `icon` | 아이콘 |
| `text` | 텍스트 컨테이너 |
| `title` | 제목 |
| `description` | 설명 텍스트 |
| `actions` | 액션 버튼 그룹 |
| `install` | 설치 버튼 |
| `close` | 닫기 버튼 |

### Usage

<Tabs>
<Tab title="HTML">
```html
<script type="module">
  import '@transcodes/ui-components/widgets/tc-installation-banner.js';
</script>

<tc-installation-banner
  id="installBanner"
  title="앱을 설치하세요"
  description="홈 화면에 추가하여 빠르게 접근하세요"
  install-label="설치"
  dismiss-days="7"
></tc-installation-banner>

<script>
  const banner = document.getElementById('installBanner');

  // 배너 표시
  banner.show();

  // 설치 버튼 클릭
  banner.addEventListener('tc-install', async () => {
    console.log('설치 시작');

    // 다양한 설치 방법 시도
    if (window.deferredPrompt) {
      // beforeinstallprompt 이벤트로 저장된 프롬프트 사용
      window.deferredPrompt.prompt();
      const { outcome } = await window.deferredPrompt.userChoice;
      console.log(`사용자 응답: ${outcome}`);
      window.deferredPrompt = null;
    } else if (
      navigator.share &&
      navigator.canShare({
        title: 'App Name',
        text: '앱을 설치하세요',
        url: window.location.href,
      })
    ) {
      // iOS Safari용 Share 사용
      await navigator.share({
        title: 'App Name',
        text: '앱을 설치하세요',
        url: window.location.href,
      });
    } else {
      console.log('설치 메서드를 사용할 수 없습니다');
    }
  });

  // 배너 닫기
  banner.addEventListener('tc-dismiss', () => {
    console.log('배너가 7일간 표시되지 않습니다');
  });

  // beforeinstallprompt 이벤트 감지
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    window.deferredPrompt = e;
    banner.show();
  });
</script>
```
</Tab>

<Tab title="React">
```jsx
import { useEffect, useRef } from 'react';
import '@transcodes/ui-components/widgets/tc-installation-banner.js';

export function InstallationBannerDemo() {
  const bannerRef = useRef(null);
  const deferredPromptRef = useRef(null);

  useEffect(() => {
    const banner = bannerRef.current;
    if (!banner) return;

    const handleInstall = async () => {
      console.log('설치 시작');

      if (deferredPromptRef.current) {
        deferredPromptRef.current.prompt();
        const { outcome } = await deferredPromptRef.current.userChoice;
        console.log(`사용자 응답: ${outcome}`);
        deferredPromptRef.current = null;
      }
    };

    const handleDismiss = () => {
      console.log('배너가 7일간 표시되지 않습니다');
    };

    const handleBeforeInstallPrompt = (e) => {
      e.preventDefault();
      deferredPromptRef.current = e;
      banner.show();
    };

    banner.addEventListener('tc-install', handleInstall);
    banner.addEventListener('tc-dismiss', handleDismiss);
    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

    // 초기 표시 시도
    banner.show();

    return () => {
      banner.removeEventListener('tc-install', handleInstall);
      banner.removeEventListener('tc-dismiss', handleDismiss);
      window.removeEventListener(
        'beforeinstallprompt',
        handleBeforeInstallPrompt
      );
    };
  }, []);

  return (
    <tc-installation-banner
      ref={bannerRef}
      title="앱을 설치하세요"
      description="홈 화면에 추가하여 빠르게 접근하세요"
      install-label="설치"
      dismiss-days="7"
    />
  );
}
```
</Tab>

<Tab title="Lit">
```typescript
import { LitElement, html } from 'lit';
import { customElement, query } from 'lit/decorators.js';
import '@transcodes/design-tokens';
import '@transcodes/ui-components/widgets/tc-installation-banner.js';
import type { TcInstallationBanner } from '@transcodes/ui-components/widgets';

@customElement('installation-banner-demo')
export class InstallationBannerDemo extends LitElement {
  @query('tc-installation-banner') private bannerRef!: TcInstallationBanner;
  private deferredPrompt: any = null;

  render() {
    return html\`
      <tc-installation-banner
        title="앱을 설치하세요"
        description="홈 화면에 추가하여 빠르게 접근하세요"
        install-label="설치"
        .dismissDays=\${7}
      ></tc-installation-banner>
    \`;
  }

  firstUpdated() {
    const banner = this.bannerRef;
    banner.addEventListener('tc-install', this.handleInstall);
    banner.addEventListener('tc-dismiss', this.handleDismiss);
    window.addEventListener('beforeinstallprompt', this.handleBeforeInstallPrompt);

    banner.show();
  }

  private handleInstall = async () => {
    console.log('설치 시작');

    if (this.deferredPrompt) {
      this.deferredPrompt.prompt();
      const { outcome } = await this.deferredPrompt.userChoice;
      console.log(\`사용자 응답: \${outcome}\`);
      this.deferredPrompt = null;
    }
  };

  private handleDismiss = () => {
    console.log('배너가 7일간 표시되지 않습니다');
  };

  private handleBeforeInstallPrompt = (e: Event) => {
    e.preventDefault();
    this.deferredPrompt = e;
    this.bannerRef?.show();
  };

  disconnectedCallback() {
    super.disconnectedCallback();
    const banner = this.bannerRef;
    banner?.removeEventListener('tc-install', this.handleInstall);
    banner?.removeEventListener('tc-dismiss', this.handleDismiss);
    window.removeEventListener('beforeinstallprompt', this.handleBeforeInstallPrompt);
  }
}
```
</Tab>
</Tabs>

### PWA 설치 감지

`beforeinstallprompt` 이벤트는 PWA가 설치 가능한 상태일 때만 발생합니다.

```javascript
let deferredPrompt = null;

window.addEventListener('beforeinstallprompt', (e) => {
  // 기본 설치 프롬프트 무시
  e.preventDefault();
  // 나중에 사용할 수 있도록 저장
  deferredPrompt = e;
  // 배너 표시
  banner.show();
});

// 사용자가 설치를 선택했을 때
async function installApp() {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    const { outcome } = await deferredPrompt.userChoice;

    if (outcome === 'accepted') {
      console.log('앱이 설치되었습니다');
    } else {
      console.log('설치가 취소되었습니다');
    }

    deferredPrompt = null;
  }
}

// 앱이 이미 설치되었을 때
window.addEventListener('appinstalled', () => {
  console.log('앱이 설치되었습니다');
  deferredPrompt = null;
});
```

<Card title="Storybook에서 보기" href="https://transcodes-ui-ui-components.vercel.app/?path=/story/widgets-tc-installation-banner" icon="external-link">
  Storybook에서 모든 상태를 확인할 수 있습니다.
</Card>

---

## tc-ios-installation-guide

iOS PWA 설치 단계를 가이드하는 모달입니다. 하단에서 슬라이드 업으로 나타납니다.

### Properties

| 속성명 | 타입 | 기본값 | 설명 |
|-------|------|-------|------|
| `title` | `string` | `'Install on iOS'` | 가이드 제목 |
| `steps` | `string[]` | [기본 3단계] | 설치 단계 배열 |

### Events

| 이벤트명 | 설명 |
|---------|------|
| `tc-close` | 가이드가 닫혔을 때 발생 |

### Methods

| 메서드명 | 반환값 | 설명 |
|---------|-------|------|
| `show()` | `Promise<void>` | 가이드 표시 |
| `close()` | `Promise<void>` | 가이드 닫기 |

### CSS Parts

| Part 이름 | 설명 |
|----------|------|
| `overlay` | 배경 오버레이 |
| `modal` | 모달 컨테이너 |
| `header` | 헤더 영역 |
| `close` | 닫기 버튼 |
| `content` | 콘텐츠 영역 |
| `steps` | 단계 컨테이너 |
| `step` | 개별 단계 |
| `step-number` | 단계 번호 |
| `step-text` | 단계 텍스트 |

### Usage

<Tabs>
<Tab title="HTML">
```html
<script type="module">
  import '@transcodes/ui-components/widgets/tc-ios-installation-guide.js';
</script>

<tc-ios-installation-guide
  id="iosGuide"
  title="iOS에 설치하기"
></tc-ios-installation-guide>

<button onclick="openGuide()">설치 방법</button>

<script>
  const guide = document.getElementById('iosGuide');

  function openGuide() {
    guide.show();
  }

  guide.addEventListener('tc-close', () => {
    console.log('가이드가 닫혔습니다');
  });

  // 모바일 Safari 감지
  function isIosSafari() {
    const ua = navigator.userAgent.toLowerCase();
    return /iphone|ipad|ipod/.test(ua) && /safari/.test(ua);
  }

  // iOS Safari에서 PWA를 설치할 수 없으면 가이드 표시
  if (isIosSafari() && !window.navigator.standalone) {
    guide.show();
  }
</script>
```
</Tab>

<Tab title="React">
```jsx
import { useRef } from 'react';
import '@transcodes/ui-components/widgets/tc-ios-installation-guide.js';

export function IosInstallationGuideDemo() {
  const guideRef = useRef(null);

  const isIosSafari = () => {
    const ua = navigator.userAgent.toLowerCase();
    return /iphone|ipad|ipod/.test(ua) && /safari/.test(ua);
  };

  const openGuide = () => {
    guideRef.current?.show();
  };

  const handleClose = () => {
    console.log('가이드가 닫혔습니다');
  };

  // iOS Safari에서 PWA를 설치할 수 없으면 가이드 표시
  React.useEffect(() => {
    if (isIosSafari() && !window.navigator.standalone) {
      guideRef.current?.show();
    }
  }, []);

  return (
    <>
      <button onClick={openGuide}>설치 방법</button>

      <tc-ios-installation-guide
        ref={guideRef}
        title="iOS에 설치하기"
        onTcClose={handleClose}
      />
    </>
  );
}
```
</Tab>

<Tab title="Lit">
```typescript
import { LitElement, html } from 'lit';
import { customElement, query } from 'lit/decorators.js';
import '@transcodes/design-tokens';
import '@transcodes/ui-components/widgets/tc-ios-installation-guide.js';
import type { TcIosInstallationGuide } from '@transcodes/ui-components/widgets';

@customElement('ios-guide-demo')
export class IosGuideDemo extends LitElement {
  @query('tc-ios-installation-guide') private guideRef!: TcIosInstallationGuide;

  render() {
    return html\`
      <div>
        <button @click=\${this.openGuide}>설치 방법</button>

        <tc-ios-installation-guide
          title="iOS에 설치하기"
          @tc-close=\${this.handleClose}
        ></tc-ios-installation-guide>
      </div>
    \`;
  }

  firstUpdated() {
    if (this.isIosSafari() && !window.navigator.standalone) {
      this.guideRef?.show();
    }
  }

  private isIosSafari(): boolean {
    const ua = navigator.userAgent.toLowerCase();
    return /iphone|ipad|ipod/.test(ua) && /safari/.test(ua);
  }

  private openGuide() {
    this.guideRef?.show();
  }

  private handleClose() {
    console.log('가이드가 닫혔습니다');
  }
}
```
</Tab>
</Tabs>

### 커스텀 단계 설정

기본 단계를 커스텀 단계로 변경할 수 있습니다:

```html
<tc-ios-installation-guide
  title="설치 가이드"
  :steps='["Safari에서 공유 버튼 [share] 탭하기", "추천 앱 리스트에서 우리 앱 찾기", "홈 화면에 추가 선택하기"]'
></tc-ios-installation-guide>
```

<Note>
특수 문자 `[share]`를 사용하면 공유 아이콘으로 자동 치환됩니다.
</Note>

### iOS PWA 설치 감지

```javascript
// 홈 화면에서 실행 중인지 확인
const isStandalone = window.navigator.standalone === true;

// Manifest 구성 (PWA 필수)
{
  "name": "앱 이름",
  "short_name": "앱",
  "description": "앱 설명",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#007AFF",
  "icons": [
    {
      "src": "/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

<Card title="Storybook에서 보기" href="https://transcodes-ui-ui-components.vercel.app/?path=/story/widgets-tc-ios-installation-guide" icon="external-link">
  Storybook에서 모든 상태를 확인할 수 있습니다.
</Card>
